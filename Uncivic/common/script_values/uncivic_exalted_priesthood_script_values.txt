uncivic_exalted_priesthood_unorthodoxy_spread_chance = {
	base = 0

	modifier = {
		add = 5
		solar_system = {
			OR = {
				any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox = yes }
				any_neighbor_system = {
					OR = {
						any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox = yes }
						any_neighbor_system = {
							OR = {
								any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox = yes }
								any_neighbor_system = {
									any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox = yes }
								}
							}
						}
					}
				}
			}
		}
	}
	modifier = {
		add = 10
		solar_system = {
			OR = {
				any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
				any_neighbor_system = {
					OR = {
						any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
						any_neighbor_system = {
							OR = {
								any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
								any_neighbor_system = {
									any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
								}
							}
						}
					}
				}
			}
		}
	}

	modifier = {
		add = 5
		is_sector_capital = no
		exists = sector
		sector.sector_capital = {
			uncivic_exalted_priesthood_planet_is_unorthodox = yes
		}
	}
	modifier = {
		add = 10
		is_sector_capital = no
		exists = sector
		sector.sector_capital = {
			uncivic_exalted_priesthood_planet_is_unorthodox_center = yes
		}
	}

	modifier = {
		add = 5
		is_sector_capital = yes
		exists = sector
		sector = {
			any_owned_planet = { uncivic_exalted_priesthood_planet_is_unorthodox = yes }
		}
	}
	modifier = {
		add = 10
		is_sector_capital = yes
		exists = sector
		sector = {
			any_owned_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
		}
	}

	modifier = {
		add = 10
		exists = sector
		exists = sector.leader
		sector.leader = {
			has_trait = uncivic_exalted_priesthood_leader_trait_unorthodox
		}
	}

	modifier = {
		subtract = 5
		exists = sector
		exists = sector.leader
		sector.leader = {
			has_trait = uncivic_exalted_priesthood_leader_trait_hardliner
		}
	}

	# no sector or non-core sector
	modifier = {
		add = 10
		OR = {
			NOT = { exists = sector }
			sector.sector_capital = {
				is_capital = no
			}
		}
	}

	add = value:uncivic_exalted_priesthood_unorthodoxy_spread_chance_from_stability

	# ethos broken? always 1.0
	# multiply = trigger:ethos

	modifier = {
		multiply = 0.6
		owner = { uncivic_exalted_priesthood_has_heresy = yes }
	}

	min = 2
	max = 90

	modifier = {
		multiply = 0
		OR = {
			is_colony = no
			is_under_colonization = yes
			is_capital = yes
			has_planet_flag = uncivic_exalted_priesthood_planet_recently_changed
			has_modifier = uncivic_exalted_priesthood_heretic_amnesty
			owner = { has_country_flag = uncivic_exalted_priesthood_recent_example }
		}
	}
}

# -1 for each stability below 50, or +0.5 for each stability above 50
uncivic_exalted_priesthood_unorthodoxy_spread_chance_from_stability = {
	base = -50
	add = trigger:planet_stability
	modifier = {
		divide = 2
		planet_stability > 50
	}
}

uncivic_exalted_priesthood_unorthodoxy_center_formation_chance = {
	base = 0
	add = value:uncivic_exalted_priesthood_unorthodoxy_spread_chance
	modifier = {
		multiply = 0
		solar_system = {
			OR = {
				any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
				any_neighbor_system = {
					OR = {
						any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
						any_neighbor_system = {
							any_system_planet = { uncivic_exalted_priesthood_planet_is_unorthodox_center = yes }
						}
					}
				}
			}
		}
	}
	modifier = {
		multiply = 0
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_focused }
	}
}

uncivic_exalted_priesthood_leader_reaction_chance = {
	base = 0
	# governor and planet in sector is unorthodox center
	modifier = {
		add = 10
		leader_class = governor
		owner = {
			any_owned_sector = {
				exists = leader
				leader = { is_same_value = prevprevprev }
				any_owned_planet = {
					uncivic_exalted_priesthood_planet_is_unorthodox_center = yes
				}
			}
		}
	}
	# governor and capital in sector is unorthodox center
	modifier = {
		add = 10
		leader_class = governor
		owner = {
			any_owned_sector = {
				exists = leader
				leader = { is_same_value = prevprevprev }
				any_owned_planet = {
					is_sector_capital = yes
					uncivic_exalted_priesthood_planet_is_unorthodox = yes
				}
			}
		}
	}
	# leader of same class is unorthodox
	modifier = {
		add = 5
		owner = {
			any_owned_leader = {
				has_trait = uncivic_exalted_priesthood_leader_trait_unorthodox
				OR = {
					AND = {
						leader_class = governor
						prevprev = { leader_class = governor }
					}
					AND = {
						leader_class = scientist
						prevprev = { leader_class = scientist }
					}
					AND = {
						leader_class = admiral
						prevprev = { leader_class = admiral }
					}
					AND = {
						leader_class = general
						prevprev = { leader_class = general }
					}
				}
			}
		}
	}
	# leader of higher level is unorthodox
	modifier = {
		add = 5
		owner = {
			any_owned_leader = {
				has_trait = uncivic_exalted_priesthood_leader_trait_unorthodox
				has_level > prevprev.trigger:has_level
			}
		}
	}
	# reduce chances if heresy declared
	modifier = {
		divide = 2
		owner = {
			uncivic_exalted_priesthood_has_heresy = yes
		}
	}

	min = 0
	max = 90
	modifier = {
		multiply = 0
		OR = {
			has_trait = uncivic_exalted_priesthood_leader_trait_unorthodox
			has_trait = uncivic_exalted_priesthood_leader_trait_hardliner
			owner = { uncivic_exalted_priesthood_has_unorthodoxy = no }
			leader_class = envoy
			leader_class = ruler
		}
	}
}

uncivic_exalted_priesthood_leader_unorthodox_chance = {
	base = 50
	modifier = {
		add = 25
		OR = {
			has_trait = leader_trait_adaptable
			has_trait = leader_trait_intellectual
			has_trait = uncivic_technocracy_scientist_trait_intellectual
			has_trait = leader_trait_corrupt
			has_trait = uncivic_technocracy_scientist_trait_corrupt
			has_trait = leader_trait_maniacal
			has_trait = uncivic_technocracy_governor_trait_maniacal
		}
	}
	modifier = {
		subtract = 25
		OR = {
			has_trait = leader_trait_stubborn
			has_trait = leader_trait_righteous
			has_trait = uncivic_technocracy_scientist_trait_righteous
		}
	}
	modifier = {
		add = 10
		leader_age < 50
	}
	modifier = {
		subtract = 5
		leader_age > 70
	}
	modifier = {
		add = 15
		owner = {
			any_pop_faction = {
				faction_approval < 0.5
				prevprev = { leader_of_faction = prev }
			}
		}
	}
	modifier = {
		multiply = 0
		owner = {
			uncivic_exalted_priesthood_has_heresy = yes
		}
	}
}

uncivic_exalted_priesthood_num_unorthodox_leaders = {
	base = 0
	complex_trigger_modifier = {
		trigger = count_owned_leader
		parameters = { limit = {
			has_trait = uncivic_exalted_priesthood_leader_trait_unorthodox
			NOT = { leader_class = ruler }
		} }
		mode = add
	}
}

uncivic_exalted_priesthood_num_hardliner_leaders = {
	base = 0
	complex_trigger_modifier = {
		trigger = count_owned_leader
		parameters = { limit = {
			has_trait = uncivic_exalted_priesthood_leader_trait_hardliner
			NOT = { leader_class = ruler }
		} }
		mode = add
	}
}

uncivic_exalted_priesthood_percent_unorthodox_planets = {
	base = 0
	complex_trigger_modifier = {
		trigger = count_owned_planet
		parameters = { limit = {
			uncivic_exalted_priesthood_planet_is_unorthodox = yes
		} }
		mode = add
	}
	divide = trigger:num_owned_planets
	multiply = 100
}

uncivic_exalted_priesthood_edict_multiplier = {
	base = 100
	subtract = value:uncivic_exalted_priesthood_percent_unorthodox_planets
	min = 10
	multiply = value:edict_size_effect
	round = yes
}

uncivic_exalted_priesthood_heresy_removal_chance = {
	base = 0
	modifier = {
		add = 50
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_focused }
		uncivic_exalted_priesthood_planet_is_unorthodox_center = yes
	}
	modifier = {
		add = 10
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_focused }
		uncivic_exalted_priesthood_planet_is_unorthodox_center = yes
	}
	modifier = {
		add = 20
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_balanced }
	}
	modifier = {
		add = 40
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_aggressive }
	}
	modifier = {
		add = 10
		owner = { has_country_flag = uncivic_exalted_priesthood_recent_amnesty }
	}
	modifier = {
		add = 10
		owner = { has_country_flag = uncivic_exalted_priesthood_recent_militia }
	}
	modifier = {
		multiply = 1.5
		exists = sector
		exists = sector.leader
		sector.leader = {
			has_trait = uncivic_exalted_priesthood_leader_trait_hardliner
		}
	}
	modifier = {
		multiply = 0
		has_planet_flag = uncivic_exalted_priesthood_planet_recently_changed
	}
}

uncivic_exalted_priesthood_inquisition_damage_chance = {
	base = 0
	modifier = {
		add = 20
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_balanced }
	}
	modifier = {
		add = 50
		owner = { has_policy_flag = uncivic_exalted_priesthood_inquisition_aggressive }
	}
	modifier = {
		add = 10
		owner = { has_country_flag = uncivic_exalted_priesthood_recent_militia }
	}
}